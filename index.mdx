import { Appear, Notes } from 'mdx-deck'
import { Invert, Split } from 'mdx-deck/layouts'
export { future as theme } from 'mdx-deck/themes' 
export { components } from 'mdx-deck-code-surfer'

export default Split

![](imgs/logo.png)

### React Hooks 

---

export default Invert

Antes de mostrar o hooks, vamos falar um pouco <br/> sobre **mixins** e **pure functions**

<Notes>
  <ul>
    <li>Falar sobre a importância de entender alguns mecanismos atuais para entender o hook</li>
  </ul>
</Notes>

---

export default Split

Alguém aqui lembra sobre mixins?

<Appear>
    <div>É uma forma de poder compartilhar "lifecycle" entre os componentes, podendo reutilizar vários casos comuns. A primeira vista parecia ser uma boa ideia.</div>
</Appear>

<Notes>
  <ul>
    <li>Mixins já vem desde da criação do react</li>
    <li>Quando o react ainda era novo em 2014</li>
  </ul>
</Notes>

---

```javascript Exemplo de mixins
var SubscriptionMixin = {
  getInitialState: function() {
    return {
      comments: DataSource.getComments()
    };
  },

  componentDidMount: function() {
    DataSource.addChangeListener(this.handleChange);
  },

  componentWillUnmount: function() {
    DataSource.removeChangeListener(this.handleChange);
  },

  handleChange: function() {
    this.setState({
      comments: DataSource.getComments()
    });
  }
};

var CommentList = React.createClass({
  mixins: [SubscriptionMixin],

  render: function() {
    // Reading comments from state managed by mixin.
    var comments = this.state.comments;
    return (
      <div>
        {comments.map(function(comment) {
          return <Comment comment={comment} key={comment.id} />
        })}
      </div>
    )
  }
});

module.exports = CommentList;
----
* > Exemplo de mixin
1:21 > Mixins
2:6 > Initial State
8:14 > Lifecycle em mixins
16:20 > Inclusão de outras funções
24 > Uso de mixin
27:28 > Poderia usar um estado gerado pelo mixin normalmente
```

<Notes>
  <ul>
    <li>É possível iniciar um estado em mixins</li>
    <li>Assim como é possível incluir ciclos de vidas do react</li>
    <li>Além de outras funções caso fosse necessário</li>
  </ul>
</Notes>

---

export default Split

<img src="https://media.giphy.com/media/eIPM3j6YXHKXC/giphy.gif"/>

#### Porém, em pouco tempo descobriram <br/> que eram bastante problemáticos, por causa da sua abordagem

<Appear>
  <div>dependência implícita</div>
  <div>conflito de nomes</div>
  <div>
    <a href='https://bit.ly/2VK97X1' target='__blank'>Mixins Considered Harmful</a><br/>
    by Dan Abramov
  </div>
</Appear>

---

export default Invert

Sobre componentes "puros" (functions)

<Appear>
  <div>são componentes mais "fácil" de escrever devido a sua leitura,<br/> porém não é possível 
  utilizar states e sempre que era necessário usar <br/>algum "lifecycle" ou state, tinha que transformar em class</div>
</Appear>
---

```javascript Componentes puros
export default function UmComponentQualquer ({ user }) {

  const name = getName(user);
  const avatar = getAvatar(user);

  return (
    <div>
      <User {...{name, avatar}} />
    </div>
  );
}
----
* > Exemplo de componente puro
```

---

export default Invert

#### Então vamos finalmente falar sobre o react hooks

<Notes>
  É quase "apenas" mais uma forma de escrever um componente, porém traz algumas caracteristicas novas
</Notes>

---

Motivação por trás do react hooks

<Appear>
  <div>É dificil compartilhar "lifecycle"</div>
  <div>Componentes complexos se tornam mais díficil de entender</div>
  <div>Classes podem ser confuso*</div>
</Appear>

---

```javascript Sintaxe do react hooks
import React, { useState } from 'react';

function Example() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>You clicked {count} times</p>
      <button onClick={() => setCount(count + 1)}>
        Click me
      </button>
    </div>
  );
}
----
* > Exemplo de react hooks
1[5:5], 4 > Uso de hooks para state
8:9 > Utilizando a função de state
```

---

Vantagens do react hooks

<Appear>
  <div>abordagem de "lifecycle" e state dentro de funções</div>
  <div>compartilhar "lifecycle" e comportamentos que são inerentes ao React</div>
  <div>mais fácil de ler, devido a sua lógica "cronológica"</div>
</Appear>

---

Algumas funções básicas do react-hooks

- useState
- useEffect
- useContext

---

```javascript Exemplo básico de useContext
import React, { useContext } from "react";

const NumberContext = React.createContext();

function App() {
  return (
    <NumberContext.Provider value={42}>
      <div>
        <Display />
      </div>
    </NumberContext.Provider>
  );
}

function Display() {
  return (
    <NumberContext.Consumer>
      {value => <div>The answer is {value}.</div>}
    </NumberContext.Consumer>
  );
}

function Display() {
  const value = useContext(NumberContext);
  return <div>The answer is {value}.</div>;
}
----
* > Exemplos
1 > Importa o useContext
3:13 > Criando um contexto
15:21 > Sem hooks
23:26 > Com hooks
```

---

Funções adicionais

- useReducer
- useCallback
- useMemo
- useRef
- useImperativeHandle
- useLayoutEffect
- useDebugValue

---

export default Invert

Reescrevendo um componente class para hooks

---

```javascript Class React
export default class MyResponsiveComponent extends React.Component {
  state = {
    width: window.innerWidth,
  }

  handleResize = () => this.setState({width: window.innerWidth});

  componentDidMount () {
    window.addEventListener('resize', this.handleResize);
  }

  componentWillUnmount () {
    window.removeEventListener('resize', this.handleResize);
  }

  render () {
    return (
      <p>Window width is {this.state.width}</p>
    );
  }
}
----
* > Exemplo de class
2:4 > Inicializando o state
6 > Criando uma função que gerenciar o estado
8:14 > Adicionando os eventos
16:20 > Renderizando o componente
```

---

```javascript Hooks
function MyResponsiveComponent() {

  const [width, setWidth] = useState(window.innerWidth);
  
  useEffect(() => {
    const handleResize = () => setWidth(window.innerWidth);
    window.addEventListener('resize', handleResize);
    return () => {
      window.removeEventListener('resize', handleResize);
    };
  });

  return (
    <p>Window width is {width}</p>
  );
}
----
* > Exemplo de hooks
3 > Inicializando o state
5:7, 11 > Executando o componentDidMount
8:10 > Executando o componentWillUnmount
13:15 > 16:20 > Renderizando o componente
```

---

```javascript Custom Hooks
function useWindowWidth() {
  const [width, setWidth] = useState(window.innerWidth);
  
  useEffect(() => {
    const handleResize = () => setWidth(window.innerWidth);
    window.addEventListener('resize', handleResize);
    return () => {
      window.removeEventListener('resize', handleResize);
    };
  });
  
  return width;
}

function MyResponsiveComponent() {
  const width = useWindowWidth(); // Our custom Hook
  return (
    <p>Window width is {width}</p>
  );
}
----
* > Exemplo
1:13 > Custom hooks
14:19 > Usando custom hooks
```

---

```javascript Perfomance Effects
import React, { useEffect, useState } from 'react'

export default function InfoUser(props) {

  const [ user, setUser ] = useState({});

  useEffect(() => {

    fetch('https://...')
    .then(user => setUser(user));

  }, [props.id])


  return (
    <div>
      <label>{user.name}</label>
    </div>
  );
}
----
* > Exemplo
7:12 > Effects
12[4:8] > Condições memorizadas

```

---

Algumas regras sobre o "hooks"

<Appear>
  <div>Deve ser chamado apenas em "top-level"</div>
  <div>Não pode ser chamado dentro de loops/statements</div>
  <div>Devem ser usado apenas porfunções react</div>
  <div>https://reactjs.org/docs/hooks-rules.html</div>
</Appear>

---

```javascript Hooks Rules
functon Component() {
  const [ count, setCount ] = useState(0);

  // Error
  if (someCondition) {
    const [ value, setValue ] = useState(0); 
  }

  return ...
}
----
* > Exemplo
2 > Jeito certo
4:7 > Jeito errado
```

---

```json ESLint para Hooks
{
  "plugins": [
    // ...
    "react-hooks"
  ],
  "rules": {
    // ...
    "react-hooks/rules-of-hooks": "error"
  }
}
----
* > https://bit.ly/2tWThMS
```

---

Algumas observações sobre o "hooks"

<Appear>
  <div>Não vai eliminar o jeito de escrever componentes em class (e eles não tem nem intenção)</div>
  <div>Funciona se usar um componente escrito em hooks, em outros componentes escrito em classes e vice-versa? Sim</div>
  <div>Não precisar começar um projeto novo para começar usar (a não ser que estiver numa versão MUITO antiga do react), basta instalar a versão minima 16.8</div>
</Appear>

---

Sim, já fizeram um "awesome"

https://bit.ly/2PXK978

---

Caso alguém queira ler um pouco mais sobre hooks

https://bit.ly/2ORRHZm

